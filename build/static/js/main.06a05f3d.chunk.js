(this["webpackJsonpcsc3916-hw5"]=this["webpackJsonpcsc3916-hw5"]||[]).push([[0],{70:function(e,t,n){},71:function(e,t,n){},85:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),s=n(21),c=n.n(s),o=(n(70),n(71),n(15)),r=n(16),l=n(19),d=n(17),u=n(96),j=n(97),h=n(33),b=n(11),O={USER_LOGGEDIN:"USER_LOGGEDIN",USER_LOGOUT:"USER_LOGOUT",FETCH_MOVIES:"FETCH_MOVIES",FETCH_MOVIE:"FETCH_MOVIE",SET_MOVIE:"SET_MOVIE",NEW_POST:"NEW_POST"},p=n(25),v=n.n(p);function m(e){var t=v()();return function(n){return fetch("".concat(t.REACT_APP_USER_API_URL,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e),mode:"cors"}).then((function(e){if(!e.ok)throw Error(e.statusText);return e.json()})).then((function(t){var i;localStorage.setItem("username",e.username),localStorage.setItem("token",t.token),n((i=e.username,{type:O.USER_LOGGEDIN,username:i}))})).catch((function(e){return console.log(e)}))}}function g(){return function(e){localStorage.removeItem("username"),localStorage.removeItem("token"),e({type:O.USER_LOGOUT})}}var x=n(2),f=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"logout",value:function(){this.props.dispatch(g())}},{key:"render",value:function(){return Object(x.jsx)("div",{children:Object(x.jsxs)(u.a,{expand:"lg",bg:"dark",variant:"dark",children:[Object(x.jsx)(u.a.Brand,{children:"Movie App"}),Object(x.jsx)(u.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(x.jsx)(u.a.Collapse,{id:"basic-navbar-nav",children:Object(x.jsxs)(j.a,{children:[Object(x.jsx)(h.LinkContainer,{to:"/movielist",children:Object(x.jsx)(j.a.Link,{disabled:!this.props.loggedIn,children:"Movie List"})}),Object(x.jsx)(h.LinkContainer,{to:"/movie/"+(this.props.selectedMovie?this.props.selectedMovie._id:""),children:Object(x.jsx)(j.a.Link,{disabled:!this.props.loggedIn,children:"Movie Detail"})}),Object(x.jsx)(h.LinkContainer,{to:"/signin",children:Object(x.jsx)(j.a.Link,{children:this.props.loggedIn?Object(x.jsx)("button",{onClick:this.logout.bind(this),children:"Logout"}):"Login"})})]})})]})})}}]),n}(i.Component),I=Object(b.b)((function(e){return{loggedIn:e.auth.loggedIn,username:e.auth.username,selectedMovie:e.movie.selectedMovie}}))(f),S=n(13);function y(e){return function(t){t(function(e){return{type:O.SET_MOVIE,selectedMovie:e}}(e))}}function E(e){var t=v()();return function(n){return fetch("".concat(t.REACT_APP_MOVIE_API_URL,"/movies/").concat(e,"?review=true"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:localStorage.getItem("token")},mode:"cors"}).then((function(e){if(!e.ok)throw Error(e.statusText);return e.json()})).then((function(e){n({type:O.FETCH_MOVIE,selectedMovie:e})})).catch((function(e){return console.log(e)}))}}function k(){var e=v()();return function(t){return fetch("".concat(e.REACT_APP_MOVIE_API_URL,"/movies?review=true"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:localStorage.getItem("token")},mode:"cors"}).then((function(e){if(!e.ok)throw Error(e.statusText);return e.json()})).then((function(e){var n;t((n=(n=e).Movielist,console.log(n),{type:O.FETCH_MOVIES,movies:n}))})).catch((function(e){return console.log(e)}))}}var C=n(90),_=n(95),M=n(39),T=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var i;return Object(o.a)(this,n),(i=t.call(this,e)).handleClick=function(e){(0,i.props.dispatch)(y(e))},i.handleSelect=i.handleSelect.bind(Object(S.a)(i)),i}return Object(r.a)(n,[{key:"componentDidMount",value:function(){(0,this.props.dispatch)(k())}},{key:"handleSelect",value:function(e,t){(0,this.props.dispatch)(y(this.props.movies[e]))}},{key:"render",value:function(){var e=this,t=function(t){var n=t.movieList;return n?Object(x.jsx)(_.a,{onSelect:e.handleSelect,children:n.map((function(t){return Object(x.jsxs)(_.a.Item,{children:[Object(x.jsx)("div",{children:Object(x.jsx)(h.LinkContainer,{to:"/movie/"+t._id,onClick:function(){return e.handleClick(t)},children:Object(x.jsx)(j.a.Link,{children:Object(x.jsx)(C.a,{className:"image",src:t.imageUrl,thumbnail:!0})})})}),Object(x.jsxs)(_.a.Caption,{children:[Object(x.jsx)("h3",{children:t.title}),Object(x.jsx)(M.a,{glyph:"star"})," ",t.ratingAvg," ","\xa0\xa0 ",t.yearReleased]})]},t._id)}))}):Object(x.jsx)("div",{children:"Loading...."})};return Object(x.jsx)(t,{movieList:this.props.movies})}}]),n}(i.Component),L=Object(b.b)((function(e){return{movies:e.movie.movies}}))(T),w=n(65),R=n(7),P=n(98),A=n(91),D=n(61),N=n(94),G=n(92),U=n(93),V=n(62),F=n(63),H=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var i;return Object(o.a)(this,n),(i=t.call(this,e)).updateDetails=i.updateDetails.bind(Object(S.a)(i)),i.submit=i.submit.bind(Object(S.a)(i)),i.handleSelect=i.handleSelect.bind(Object(S.a)(i)),i.state={details:{rating:void 0,quote:void 0}},i}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;void 0==this.props.selectedMovie&&e(E(this.props.movieId))}},{key:"shouldComponentUpdate",value:function(e,t){return this.props.number!==e.number}},{key:"updateDetails",value:function(e){var t=Object.assign({},this.state.details);t[e.target.name]=e.target.value,this.setState({details:t})}},{key:"handleSelect",value:function(e){var t=Object.assign({},this.state.details);t.rating=parseInt(e),this.setState({details:t}),console.log(this.state.details)}},{key:"submit",value:function(){var e,t;(0,this.props.dispatch)((e=this.state.details,t=this.props.movieId,function(n){var i=v()();window.localStorage.getItem("token"),e.movie=t,console.log(e),fetch("".concat(i.REACT_APP_MOVIE_API_URL,"/reviews"),{method:"POST",headers:{"content-type":"application/json",Authorization:"JWT ".concat(localStorage.getItem("token"))},mode:"cors",body:JSON.stringify(e)}).then((function(e){if(!e.ok)throw Error(e.statusText);return e.json()})).then((function(e){return n({type:O.NEW_POST,movieId:t})}))}))}},{key:"render",value:function(){var e=this,t=function(){return e.props.selectedMovie?Object(x.jsxs)(P.a,{children:[Object(x.jsx)(P.a.Header,{children:"Movie Detail"}),Object(x.jsx)(P.a.Body,{children:Object(x.jsx)(C.a,{className:"image",src:e.props.selectedMovie.imageUrl,thumbnail:!0})}),Object(x.jsxs)(A.a,{children:[Object(x.jsx)(D.a,{children:e.props.selectedMovie.title}),Object(x.jsx)(D.a,{children:e.props.selectedMovie.actors.map((function(e,t){return Object(x.jsxs)("p",{children:[Object(x.jsx)("b",{children:e.actorName})," ",e.characterName]},t)}))}),Object(x.jsx)(D.a,{children:Object(x.jsxs)("h4",{children:[Object(x.jsx)(M.a,{})," ",e.props.selectedMovie.ratingAvg]})})]}),Object(x.jsx)(P.a.Body,{children:e.props.selectedMovie.review.map((function(e,t){return Object(x.jsxs)("p",{children:[Object(x.jsx)("b",{children:e.nameOfReviewer}),"\xa0 ",e.quote,"\xa0 ",Object(x.jsx)(M.a,{})," ",e.rating]},t)}))}),Object(x.jsx)(P.a.Body,{children:Object(x.jsxs)(N.a,{className:"review-form",onSubmit:e.submit,children:[Object(x.jsxs)(N.a.Group,{controlId:"exampleForm.ControlTextarea1",children:[Object(x.jsx)(N.a.Label,{children:"Comment"}),Object(x.jsx)(N.a.Control,{id:"text-field",name:"quote",onChange:e.updateDetails,value:e.state.details.quote,as:"textarea",rows:2,cols:1})]}),Object(x.jsx)("fieldset",{children:Object(x.jsx)(N.a.Group,{as:G.a,children:Object(x.jsxs)(U.a,{className:"rating-btn",drop:"up",onSelect:e.handleSelect,value:e.state.details.rating,children:[Object(x.jsx)(U.a.Toggle,{variant:"Secondary",id:"dropdown-basic",children:"Rating"}),Object(x.jsxs)(U.a.Menu,{children:[Object(x.jsx)(U.a.Item,{eventKey:"1",children:"1"}),Object(x.jsx)(U.a.Item,{eventKey:"2",children:"2"}),Object(x.jsx)(U.a.Item,{eventKey:"3",children:"3"}),Object(x.jsx)(U.a.Item,{eventKey:"4",children:"4"}),Object(x.jsx)(U.a.Item,{eventKey:"5",children:"5"})]})]})})}),Object(x.jsx)(N.a.Group,{as:G.a,children:Object(x.jsx)(V.a,{sm:{span:1,offset:0},children:Object(x.jsx)(F.a,{className:"submit-btn",type:"submit",onSubmit:e.submit,children:"Submit"})})})]})})]}):Object(x.jsx)("div",{children:"Loading...."})};return Object(x.jsx)(t,{})}}]),n}(i.Component),B=Object(b.b)((function(e){return{selectedMovie:e.movie.selectedMovie}}))(H);var J=function(e){var t=Object(i.useState)(e.selectedMovie),n=Object(w.a)(t,1)[0],a=Object(R.m)().movieId;console.log(a);var s=Object(b.c)();return null==n&&s(E(a)),Object(x.jsx)(B,{movieId:a})},z=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var i;return Object(o.a)(this,n),(i=t.call(this,e)).updateDetails=i.updateDetails.bind(Object(S.a)(i)),i.login=i.login.bind(Object(S.a)(i)),i.state={details:{username:"",password:""}},i}return Object(r.a)(n,[{key:"updateDetails",value:function(e){var t=Object.assign({},this.state.details);t[e.target.id]=e.target.value,this.setState({details:t})}},{key:"login",value:function(){(0,this.props.dispatch)(m(this.state.details))}},{key:"render",value:function(){return Object(x.jsxs)(N.a,{className:"form-horizontal",children:[Object(x.jsxs)(N.a.Group,{controlId:"username",children:[Object(x.jsx)(N.a.Label,{children:"Email"}),Object(x.jsx)(N.a.Control,{onChange:this.updateDetails,value:this.state.details.username,type:"email",placeholder:"Enter email"})]}),Object(x.jsxs)(N.a.Group,{controlId:"password",children:[Object(x.jsx)(N.a.Label,{children:"Password"}),Object(x.jsx)(N.a.Control,{onChange:this.updateDetails,value:this.state.details.password,type:"password",placeholder:"Password"})]}),Object(x.jsx)(F.a,{onClick:this.login,children:"Sign in"})]})}}]),n}(i.Component),K=Object(b.b)((function(e){return{}}))(z),W=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var i;return Object(o.a)(this,n),(i=t.call(this,e)).updateDetails=i.updateDetails.bind(Object(S.a)(i)),i.register=i.register.bind(Object(S.a)(i)),i.state={details:{name:"",username:"",password:""}},i}return Object(r.a)(n,[{key:"updateDetails",value:function(e){var t=Object.assign({},this.state.details);t[e.target.id]=e.target.value,this.setState({details:t})}},{key:"register",value:function(){(0,this.props.dispatch)(function(e){var t=v()();return function(n){return fetch("".concat(t.REACT_APP_USER_API_URL,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e),mode:"cors"}).then((function(e){if(!e.ok)throw Error(e.statusText);return e.json()})).then((function(t){n(m(e))})).catch((function(e){return console.log(e)}))}}(this.state.details))}},{key:"render",value:function(){return Object(x.jsxs)(N.a,{className:"form-horizontal",children:[Object(x.jsxs)(N.a.Group,{controlId:"name",children:[Object(x.jsx)(N.a.Label,{children:"Name"}),Object(x.jsx)(N.a.Control,{onChange:this.updateDetails,value:this.state.details.name,type:"text",placeholder:"Name"})]}),Object(x.jsxs)(N.a.Group,{controlId:"username",children:[Object(x.jsx)(N.a.Label,{children:"Email"}),Object(x.jsx)(N.a.Control,{onChange:this.updateDetails,value:this.state.details.username,type:"email",placeholder:"Enter email"})]}),Object(x.jsxs)(N.a.Group,{controlId:"password",children:[Object(x.jsx)(N.a.Label,{children:"Password"}),Object(x.jsx)(N.a.Control,{onChange:this.updateDetails,value:this.state.details.password,type:"password",placeholder:"Password"})]}),Object(x.jsx)(F.a,{onClick:this.register,children:"Register"})]})}}]),n}(i.Component),q=Object(b.b)((function(e){return{}}))(W),Q=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(o.a)(this,n),(e=t.call(this)).state={toggleReg:!1},e}return Object(r.a)(n,[{key:"componentDidMount",value:function(){}},{key:"showLogin",value:function(){this.setState({toggleReg:!1})}},{key:"showReg",value:function(){this.setState({toggleReg:!0})}},{key:"logout",value:function(){this.props.dispatch(g())}},{key:"render",value:function(){var e=Object(x.jsxs)("div",{children:[Object(x.jsx)("button",{onClick:this.showLogin.bind(this),children:"Login"}),Object(x.jsx)("button",{onClick:this.showReg.bind(this),children:"Register"}),this.state.toggleReg?Object(x.jsx)(q,{}):Object(x.jsx)(K,{})]}),t=Object(x.jsxs)("div",{children:["Logged in as: ",this.props.username," ",Object(x.jsx)("button",{onClick:this.logout.bind(this),children:"Logout"})]});return Object(x.jsx)("div",{children:this.props.loggedIn?t:e})}}]),n}(i.Component),X=Object(b.b)((function(e){return{loggedIn:e.auth.loggedIn,username:e.auth.username}}))(Q),Y=n(35),Z=n(34),$=n(64),ee={loggedIn:!!localStorage.getItem("token"),username:localStorage.getItem("username")?localStorage.getItem("username"):""},te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee,t=arguments.length>1?arguments[1]:void 0,n=Object.assign({},e);switch(t.type){case O.USER_LOGGEDIN:return n.loggedIn=!0,n.username=t.username,n;case O.USER_LOGOUT:return n.loggedIn=!1,n.username="",n;default:return e}},ne={movies:[],selectedMovie:null},ie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ne,t=arguments.length>1?arguments[1]:void 0,n=Object.assign({},e);switch(t.type){case O.FETCH_MOVIES:return n.movies=t.movies,n.selectedMovie=t.movies[0],n;case O.SET_MOVIE:case O.FETCH_MOVIE:return n.selectedMovie=t.selectedMovie,n;default:return e}},ae={items:[],item:{}},se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae,t=arguments.length>1?arguments[1]:void 0;t.movieId,Object.assign({},e);switch(t.type){case O.NEW_POST:default:return e}},ce=[$.a],oe=Object(Z.d)(Object(Z.c)({auth:te,movie:ie,review:se}),Z.a.apply(void 0,ce));var re=function(){return Object(x.jsx)("div",{className:"App",children:Object(x.jsx)(b.a,{store:oe,children:Object(x.jsx)(Y.HashRouter,{children:Object(x.jsxs)("div",{children:[Object(x.jsx)(I,{}),Object(x.jsx)(R.d,{exact:!0,path:"/",render:function(){return Object(x.jsx)(L,{})}}),Object(x.jsx)(R.d,{exact:!0,path:"/movielist",render:function(){return Object(x.jsx)(L,{})}}),Object(x.jsx)(R.d,{exact:!0,path:"/movie/:movieId",render:function(){return Object(x.jsx)(J,{})}}),Object(x.jsx)(R.d,{path:"/signin",render:function(){return Object(x.jsx)(X,{})}})]})})})})},le=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,99)).then((function(t){var n=t.getCLS,i=t.getFID,a=t.getFCP,s=t.getLCP,c=t.getTTFB;n(e),i(e),a(e),s(e),c(e)}))};c.a.render(Object(x.jsx)(a.a.StrictMode,{children:Object(x.jsx)(re,{})}),document.getElementById("root")),le()}},[[85,1,2]]]);
//# sourceMappingURL=main.06a05f3d.chunk.js.map